// Generated by CoffeeScript 1.9.3
(function() {
  var $, AJAXWorkersManager;

  $ = jQuery;

  AJAXWorkersManager = (function() {
    var shownFirstWorkersId;

    shownFirstWorkersId = [];

    function AJAXWorkersManager(container) {
      this.container = container;
    }

    AJAXWorkersManager.prototype.getWorkersBoss = function(bossId, count) {

      /* Get subordinates boss
      
      bossId: Id user.
          If bossId = "first-hierarchy" show users who are not have boss.
      
      count: Count list workers.
      
      listUnnecessaryId: Already get and show workers.
          No need to re-receive.
       */
      var request;
      request = $.ajax({
        url: "/workers/",
        type: "GET",
        data: {
          boss: bossId,
          count: count,
          unnecessaryId: encodeURI(shownFirstWorkersId.join())
        },
        async: false
      });
      if (bossId === "first-hierarchy") {
        request.done(this.AJAXsuccessGetWorkers);
        return request.fail(this.AJAXerrorGetWorkers);
      } else {

      }
    };

    AJAXWorkersManager.prototype.AJAXsuccessGetWorkers = function(data, textStatus, jqXHR) {
      var element, frn, i, len, results;
      frn = function(element) {
        var html;
        shownFirstWorkersId.push(element.id);
        html = "<div class=\"employee row\">\n<div class=\"col-md-3\"><img src=\"https://avatars0.githubusercontent.com/u/31619203?s=40&amp;v=4\" alt=\"Logo\" width=\"50\" height=\"50\" class=\"img-circle\"/></div>\n<div class=\"col-md-3\">\n  <p>" + element.name + "</p>\n</div>\n<div class=\"col-md-3\">\n  <p>" + element.work_position + "</p>\n</div>\n<div class=\"col-md-3\">\n  <p>" + element.chief + "</p>\n</div>\n</div>";
        return $('.container-workers').append(html);
      };
      results = [];
      for (i = 0, len = data.length; i < len; i++) {
        element = data[i];
        results.push(frn(element));
      }
      return results;
    };

    AJAXWorkersManager.prototype.AJAXerrorGetWorkers = function(jqXHR, textStatus, errorThrown) {
      return console.log("Error: " + jqXHR + ", " + textStatus + ", " + errorThrown);
    };

    AJAXWorkersManager.prototype.showFirstHierarchy = function(count) {
      if (count == null) {
        count = 100;
      }

      /* Display list first hierarchy 
      
      count: Get count users
       */
      return this.getWorkersBoss("first-hierarchy", count);
    };

    AJAXWorkersManager.prototype.showWorkersInTree = function(parentEmployeeContainer) {

      /* Show 2 and more hierarchy workers */
    };

    AJAXWorkersManager.prototype.getShownedListId = function() {
      return console.log(shownFirstWorkersId);
    };

    return AJAXWorkersManager;

  })();

  $(document).ready(function() {
    var me2;
    me2 = new AJAXWorkersManager(".container-workers");
    return me2.showFirstHierarchy();
  });

}).call(this);
